---
mapped_pages:
  - https://www.elastic.co/guide/en/security/current/endpoint-protection-rules.html
  - https://www.elastic.co/guide/en/serverless/current/endpoint-protection-rules.html
applies_to:
  stack: all
  serverless:
    security: all
products:
  - id: security
  - id: cloud-serverless
---

# Endpoint protection rules [endpoint-protection-rules]

Endpoint protection rules are [prebuilt rules](../detect-and-alert/install-manage-elastic-prebuilt-rules.md) designed to help you manage and respond to alerts generated by {{elastic-endpoint}}, the installed component that performs {{elastic-defend}}'s threat monitoring and prevention. These rules include the Endpoint Security ({{elastic-defend}}) rule as well as additional detection and prevention rules for different {{elastic-defend}} protection features.

::::{important}
To receive {{elastic-endpoint}} alerts, you must install {{agent}} and the {{elastic-defend}} integration  on your hosts (refer to [Install {{elastic-defend}}](../configure-elastic-defend/install-elastic-defend.md)).
::::


When endpoint protection rules are triggered, {{elastic-endpoint}} alerts are displayed as detection alerts in the {{security-app}}. The detection alert name is taken from the {{elastic-endpoint}} alert message and overwrites the prebuilt rule name in the Alerts table. For example, for malware protection, the following {{elastic-endpoint}} alerts are displayed as detection alerts:

* Malware Prevention Alert
* Malware Detection Alert


## Endpoint Security rule [endpoint-sec-rule]

The [Endpoint Security ({{elastic-defend}})](detection-rules://rules/integrations/endpoint/elastic_endpoint_security.md) rule automatically creates an alert from all incoming {{elastic-endpoint}} alerts.

::::{note}
When you install Elastic prebuilt rules, the Endpoint Security ({{elastic-defend}}) rule is enabled by default.
::::



## Feature-specific protection rules [feature-protection-rules]

The following endpoint protection rules give you more granular control over how you handle the generated alerts. These rules are tailored for each of {{elastic-defend}}'s endpoint protection featuresâ€”malware, ransomware, memory threats, and malicious behavior. Enabling these rules allows you to configure more specific actions based on the protection feature and whether the malicious activity was prevented or detected.

* [Behavior - Detected - {{elastic-defend}}](detection-rules://rules/integrations/endpoint/elastic_endpoint_security_behavior_detected.md)
* [Behavior - Prevented - {{elastic-defend}}](detection-rules://rules/integrations/endpoint/elastic_endpoint_security_behavior_prevented.md)
* [Malicious File - Detected - {{elastic-defend}}](detection-rules://rules/integrations/endpoint/execution_elastic_malicious_file_detected.md)
* [Malicious File - Prevented - {{elastic-defend}}](detection-rules://rules/integrations/endpoint/execution_elastic_malicious_file_prevented.md)
* [Memory Threat - Detected - {{elastic-defend}}](detection-rules://rules/integrations/endpoint/defense_evasion_elastic_memory_threat_detected.md)
* [Memory Threat - Prevented - {{elastic-defend}}](detection-rules://rules/integrations/endpoint/defense_evasion_elastic_memory_threat_prevented.md)
* [Ransomware - Detected - {{elastic-defend}}](detection-rules://rules/integrations/endpoint/impact_elastic_ransomware_detected.md)
* [Ransomware - Prevented - {{elastic-defend}}](detection-rules://rules/integrations/endpoint/impact_elastic_ransomware_prevented.md)

::::{note}
If you choose to use the feature-specific protection rules, we recommend that you disable the Endpoint Security ({{elastic-defend}}) rule, as using both will result in duplicate alerts.
::::


To use these rules, you need to manually enable them from the **Rules** page in the {{security-app}}. Follow the instructions for [installing and enabling Elastic prebuilt rules](../detect-and-alert/install-manage-elastic-prebuilt-rules.md#load-prebuilt-rules).


## Endpoint security exception handling [_endpoint_security_exception_handling]

All endpoint protection rules share a common exception list called the Endpoint Security Exception List. This ensures that if you switch between using the Endpoint Security ({{elastic-defend}}) rule and the feature-specific protection rules, your existing [{{elastic-endpoint}} exceptions](../detect-and-alert/add-manage-exceptions.md#endpoint-rule-exceptions) continue to apply.
